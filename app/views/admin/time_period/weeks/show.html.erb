<div class="container flex flex-col gap-8 w-full p-8">

  <%= render partial: "admin/icon-breadcrumbs", locals: {
    items: [
      {
        icon: "fa-solid fa-lock",
        href: "/admin",
        text: "Admin",
      },
      {
        icon: "fa-solid fa-calendar-week",
        href: "/admin/time_period/weeks",
        text: "Weeks",
      },
    ]
  } %>

  <%= render partial: "admin/icon-heading", locals: {
    icon: "fa-solid fa-calendar-week",
    text: @week.week_code,
  } %>

  <%= render partial: "admin/icon-list", locals: {
    items: @week.days.map do |day|
      {
        icon: "fa-solid fa-calendar-days",
        top: {
          text: "#{day.ymd} (#{day.date.strftime("%A")})",
          href: "/admin/time_period/days/#{day.id}",
        },
        bottom: {
          text: "#{day.searches.count} searches, #{day.results.count} results, #{day.documents.count} documents",
        },
    }
    end
  } %>

  <%= button_to(
    "Update",
    "/admin/time_period/weeks/#{@week.id}/job",
    method: :post,
    class: "min-w-max-content bg-cyan-300 hover:bg-cyan-200 text-black font-bold py-2 px-4 rounded"
  ) %>


  <% if @prev.present? %>
    <a href="/admin/time_period/weeks/<%= @prev.id %>" class="text-blue-700 underline">
      Prev
    </a>
  <% end %>

<%= @next_code %>
  <% if @next.present? %>
    <a href="/admin/time_period/weeks/<%= @next.id %>" class="text-blue-700 underline">
      Next
    </a>
  <% end %>


  <div class="flex flex-row justify-between">
    <h2 class="text-2xl font-bold">
      Documents
    </h2>
  </div>
  <%= column_chart @week.days.chronological.map { |d| [d.date.strftime("%Y-%m-%d"), d.documents.count] }.to_h %>

</div>